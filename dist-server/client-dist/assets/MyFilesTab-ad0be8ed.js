import{j as e,u as O,F as z}from"./index-f88750f1.js";import{r as a}from"./react-vendor-a308f804.js";import"./router-vendor-90630356.js";import"./anime-vendor-37453147.js";const G=({isOpen:r,onClose:h,title:j,message:u,type:o="success"})=>{if(a.useEffect(()=>{if(r){const d=setTimeout(()=>{h()},3e3);return()=>clearTimeout(d)}},[r,h]),!r)return null;const b=()=>{switch(o){case"success":return"âœ“";case"error":return"âœ•";case"warning":return"âš ";case"info":return"â„¹";default:return"âœ“"}};return e.jsx("div",{className:"success-modal-overlay",children:e.jsxs("div",{className:`success-modal success-modal-${o}`,children:[e.jsxs("div",{className:"success-modal-content",children:[e.jsx("div",{className:`success-icon success-icon-${o}`,children:b()}),e.jsxs("div",{className:"success-text",children:[j&&e.jsx("h3",{className:"success-title",children:j}),e.jsx("p",{className:"success-message",children:u})]}),e.jsx("button",{className:"success-close",onClick:h,type:"button",children:"Ã—"})]}),e.jsx("div",{className:"success-progress-bar",children:e.jsx("div",{className:`success-progress-fill success-progress-${o}`})})]})})},H=({filteredFiles:r,isLoading:h,fetchUserFiles:j,formatFileSize:u,files:o,user:b})=>{a.useState(!1);const[d,v]=a.useState({isOpen:!1,title:"",message:"",type:"success"}),l=a.useMemo(()=>r.filter(s=>s.status==="final_approved"||s.status==="uploaded"||s.status==="team_leader_approved"||s.status==="rejected_by_team_leader"||s.status==="rejected_by_admin"),[r]),[g,k]=a.useState(7),{currentPage:n,paginatedItems:P,goToPage:f,canGoNext:C,canGoPrev:T,totalPages:c,startIndex:F,endIndex:R,resetPagination:y}=O(l,g),x=a.useRef(null),p=a.useRef(null),E=300,w=a.useCallback(async s=>{try{if(window.electron&&window.electron.openFileInApp){const t=await(await fetch(`http://localhost:3001/api/files/${s.id}/path`)).json();if(t.success&&t.filePath){const m=await window.electron.openFileInApp(t.filePath);m.success||v({isOpen:!0,title:"Error",message:m.error||"Failed to open file with system application",type:"error"})}else throw new Error("Could not get file path")}else{const i=`http://localhost:3001${s.file_path}`;window.open(i,"_blank","noopener,noreferrer")}}catch(i){console.error("Error opening file:",i),v({isOpen:!0,title:"Error",message:"Failed to open file. Please try again.",type:"error"})}},[]),S=a.useCallback((s,i)=>{i.stopPropagation(),x.current&&clearTimeout(x.current),p.current===s.id?(p.current=null,w(s)):(p.current=s.id,x.current=setTimeout(()=>{p.current=null},E))},[w]);a.useEffect(()=>()=>{x.current&&clearTimeout(x.current)},[]);const M=a.useCallback(s=>{if(!s)return"Pending";switch(s){case"uploaded":return"Pending Team Leader";case"team_leader_approved":return"Pending Admin";case"final_approved":return"Approved";case"rejected_by_team_leader":return"Rejected by Team Leader";case"rejected_by_admin":return"Rejected by Admin";default:return"Pending"}},[]),A=a.useCallback(s=>{switch(s){case"uploaded":case"team_leader_approved":return"status-pending";case"final_approved":return"status-approved";case"rejected_by_team_leader":case"rejected_by_admin":return"status-rejected";default:return"status-default"}},[]),I=a.useCallback(s=>{const i=new Date(s),t=i.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),m=i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});return{date:t,time:m}},[]),_=a.useMemo(()=>l.filter(s=>s.status==="uploaded"||s.status==="team_leader_approved"),[l]),L=a.useMemo(()=>l.filter(s=>s.status==="final_approved"),[l]),$=a.useMemo(()=>l.filter(s=>s.status==="rejected_by_team_leader"||s.status==="rejected_by_admin"),[l]),D=a.useMemo(()=>l.reduce((s,i)=>s+i.file_size,0),[l]);a.useEffect(()=>{y()},[r,g,y]);const N=a.useCallback(s=>{f(s),window.scrollTo({top:0,behavior:"smooth"})},[f]),B=a.useCallback(s=>{k(Number(s.target.value))},[]),U=a.useCallback(()=>{const s=[];if(c<=5)for(let t=1;t<=c;t++)s.push(t);else if(n<=3){for(let t=1;t<=4;t++)s.push(t);s.push("..."),s.push(c)}else if(n>=c-2){s.push(1),s.push("...");for(let t=c-3;t<=c;t++)s.push(t)}else{s.push(1),s.push("...");for(let t=n-1;t<=n+1;t++)s.push(t);s.push("..."),s.push(c)}return s},[n,c]);return e.jsxs("div",{className:"user-my-files-component my-files-wrapper",children:[e.jsx("div",{className:"my-files-header-top",children:h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"header-left",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"32px",width:"140px",marginBottom:"12px",borderRadius:"8px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"18px",width:"200px",borderRadius:"6px"}})]}),e.jsxs("div",{className:"stats-row",children:[e.jsxs("div",{className:"stat-box-skeleton",children:[e.jsx("div",{className:"skeleton-circle",style:{width:"56px",height:"56px"}}),e.jsxs("div",{className:"stat-text-skeleton",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"28px",width:"40px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"14px",width:"140px",borderRadius:"6px"}})]})]}),e.jsxs("div",{className:"stat-box-skeleton",children:[e.jsx("div",{className:"skeleton-circle",style:{width:"56px",height:"56px"}}),e.jsxs("div",{className:"stat-text-skeleton",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"28px",width:"40px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"14px",width:"140px",borderRadius:"6px"}})]})]}),e.jsxs("div",{className:"stat-box-skeleton",children:[e.jsx("div",{className:"skeleton-circle",style:{width:"56px",height:"56px"}}),e.jsxs("div",{className:"stat-text-skeleton",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"28px",width:"40px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"14px",width:"140px",borderRadius:"6px"}})]})]}),e.jsxs("div",{className:"stat-box-skeleton",children:[e.jsx("div",{className:"skeleton-circle",style:{width:"56px",height:"56px"}}),e.jsxs("div",{className:"stat-text-skeleton",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"28px",width:"40px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"14px",width:"140px",borderRadius:"6px"}})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{children:"My Files"}),e.jsxs("p",{className:"header-subtitle",children:[l.length," files â€¢ ",u(D)," total"]})]}),e.jsxs("div",{className:"stats-row",children:[e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-icon",children:"TL"}),e.jsxs("div",{className:"stat-text",children:[e.jsx("div",{className:"stat-number",children:_.filter(s=>s.status==="uploaded").length}),e.jsx("div",{className:"stat-name",children:"Pending Team Leader"})]})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-icon",children:"AD"}),e.jsxs("div",{className:"stat-text",children:[e.jsx("div",{className:"stat-number",children:_.filter(s=>s.status==="team_leader_approved").length}),e.jsx("div",{className:"stat-name",children:"Pending Admin"})]})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-icon",children:"AP"}),e.jsxs("div",{className:"stat-text",children:[e.jsx("div",{className:"stat-number",children:L.length}),e.jsx("div",{className:"stat-name",children:"Approved Files"})]})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-icon",children:"RE"}),e.jsxs("div",{className:"stat-text",children:[e.jsx("div",{className:"stat-number",children:$.length}),e.jsx("div",{className:"stat-name",children:"Rejected Files"})]})]})]})]})}),e.jsx("div",{className:"files-table-wrapper",children:l.length>0?e.jsxs("div",{className:"files-list",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("div",{className:"col-filename",children:"FILENAME"}),e.jsx("div",{className:"col-datetime",children:"DATE & TIME"}),e.jsx("div",{className:"col-team",children:"TEAM"}),e.jsx("div",{className:"col-status",children:"STATUS"})]}),P.map(s=>{const{date:i,time:t}=I(s.uploaded_at);return e.jsxs("div",{className:"file-row-new",onClick:m=>S(s,m),title:"Double click to open file",children:[e.jsxs("div",{className:"col-filename",children:[e.jsx(z,{fileType:s.original_name.split(".").pop().toLowerCase(),isFolder:!1,size:"default",altText:`${s.file_type} file`,style:{width:"44px",height:"44px"}}),e.jsxs("div",{className:"file-text",children:[e.jsx("div",{className:"filename",children:s.original_name}),e.jsx("div",{className:"filesize",children:u(s.file_size)}),e.jsxs("div",{className:"datetime-mobile",children:[e.jsx("div",{className:"date-label",children:i}),e.jsx("div",{className:"time-label",children:t})]})]})]}),e.jsxs("div",{className:"col-datetime",children:[e.jsx("div",{className:"date-label",children:i}),e.jsx("div",{className:"time-label",children:t})]}),e.jsx("div",{className:"col-team",children:e.jsx("span",{className:"team-text",children:s.user_team})}),e.jsx("div",{className:"col-status",children:e.jsx("span",{className:`status-tag ${A(s.status)}`,children:M(s.status)})})]},s.id)})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“‹"}),e.jsx("h3",{children:"No files found"}),e.jsx("p",{children:o.length===0?"Ready to upload your first file? Click the button above to get started.":"No files match your current search criteria."})]})}),l.length>0&&e.jsxs("div",{className:"pagination-wrapper",children:[e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"pagination-text",children:["Showing ",F+1," to ",R," of ",l.length," files"]}),e.jsxs("div",{className:"items-per-page",children:[e.jsx("label",{htmlFor:"itemsPerPage",children:"Show:"}),e.jsxs("select",{id:"itemsPerPage",value:g,onChange:B,className:"items-select",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]}),e.jsxs("div",{className:"pagination-controls",children:[e.jsx("button",{className:"pagination-btn pagination-prev",onClick:()=>N(n-1),disabled:!T,title:"Previous page",children:e.jsx("span",{children:"â€¹"})}),U().map((s,i)=>s==="..."?e.jsx("span",{className:"pagination-ellipsis",children:"..."},`ellipsis-${i}`):e.jsx("button",{className:`pagination-btn pagination-number ${n===s?"active":""}`,onClick:()=>N(s),children:s},s)),e.jsx("button",{className:"pagination-btn pagination-next",onClick:()=>N(n+1),disabled:!C,title:"Next page",children:e.jsx("span",{children:"â€º"})})]})]}),e.jsx(G,{isOpen:d.isOpen,onClose:()=>v({...d,isOpen:!1}),title:d.title,message:d.message,type:d.type})]})};export{H as default};
