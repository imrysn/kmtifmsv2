import{j as e,F as L}from"./index-806ce2e8.js";import{r as a}from"./react-vendor-a308f804.js";import"./router-vendor-90630356.js";import"./anime-vendor-37453147.js";const $=({isOpen:d,onClose:x,title:v,message:p,type:m="success"})=>{if(a.useEffect(()=>{if(d){const o=setTimeout(()=>{x()},3e3);return()=>clearTimeout(o)}},[d,x]),!d)return null;const b=()=>{switch(m){case"success":return"âœ“";case"error":return"âœ•";case"warning":return"âš ";case"info":return"â„¹";default:return"âœ“"}};return e.jsx("div",{className:"success-modal-overlay",children:e.jsxs("div",{className:`success-modal success-modal-${m}`,children:[e.jsxs("div",{className:"success-modal-content",children:[e.jsx("div",{className:`success-icon success-icon-${m}`,children:b()}),e.jsxs("div",{className:"success-text",children:[v&&e.jsx("h3",{className:"success-title",children:v}),e.jsx("p",{className:"success-message",children:p})]}),e.jsx("button",{className:"success-close",onClick:x,type:"button",children:"Ã—"})]}),e.jsx("div",{className:"success-progress-bar",children:e.jsx("div",{className:`success-progress-fill success-progress-${m}`})})]})})},z=({filteredFiles:d,isLoading:x,fetchUserFiles:v,formatFileSize:p,files:m,user:b})=>{a.useState(!1);const[o,g]=a.useState({isOpen:!1,title:"",message:"",type:"success"}),[n,f]=a.useState(1),[c,_]=a.useState(7),u=a.useRef(null),j=a.useRef(null),k=300,y=a.useCallback(async s=>{try{if(window.electron&&window.electron.openFileInApp){const t=await(await fetch(`http://localhost:3001/api/files/${s.id}/path`)).json();if(t.success&&t.filePath){const h=await window.electron.openFileInApp(t.filePath);h.success||g({isOpen:!0,title:"Error",message:h.error||"Failed to open file with system application",type:"error"})}else throw new Error("Could not get file path")}else{const i=`http://localhost:3001${s.file_path}`;window.open(i,"_blank","noopener,noreferrer")}}catch(i){console.error("Error opening file:",i),g({isOpen:!0,title:"Error",message:"Failed to open file. Please try again.",type:"error"})}},[]),P=a.useCallback((s,i)=>{i.stopPropagation(),u.current&&clearTimeout(u.current),j.current===s.id?(j.current=null,y(s)):(j.current=s.id,u.current=setTimeout(()=>{j.current=null},k))},[y]);a.useEffect(()=>()=>{u.current&&clearTimeout(u.current)},[]);const C=a.useCallback(s=>{if(!s)return"Pending";switch(s){case"uploaded":return"Pending Team Leader";case"team_leader_approved":return"Pending Admin";case"final_approved":return"Approved";case"rejected_by_team_leader":return"Rejected by Team Leader";case"rejected_by_admin":return"Rejected by Admin";default:return"Pending"}},[]),F=a.useCallback(s=>{switch(s){case"uploaded":case"team_leader_approved":return"status-pending";case"final_approved":return"status-approved";case"rejected_by_team_leader":case"rejected_by_admin":return"status-rejected";default:return"status-default"}},[]),T=a.useCallback(s=>{const i=new Date(s),t=i.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),h=i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});return{date:t,time:h}},[]),l=a.useMemo(()=>d.filter(s=>s.status==="final_approved"||s.status==="uploaded"||s.status==="team_leader_approved"||s.status==="rejected_by_team_leader"||s.status==="rejected_by_admin"),[d]),w=a.useMemo(()=>l.filter(s=>s.status==="uploaded"||s.status==="team_leader_approved"),[l]),R=a.useMemo(()=>l.filter(s=>s.status==="final_approved"),[l]),M=a.useMemo(()=>l.filter(s=>s.status==="rejected_by_team_leader"||s.status==="rejected_by_admin"),[l]),S=a.useMemo(()=>l.reduce((s,i)=>s+i.file_size,0),[l]),r=a.useMemo(()=>Math.ceil(l.length/c),[l.length,c]),E=a.useMemo(()=>{const s=(n-1)*c,i=s+c;return l.slice(s,i)},[l,n,c]);a.useEffect(()=>{f(1)},[d,c]);const N=a.useCallback(s=>{f(s),window.scrollTo({top:0,behavior:"smooth"})},[]),A=a.useCallback(s=>{_(Number(s.target.value))},[]),I=a.useCallback(()=>{const s=[];if(r<=5)for(let t=1;t<=r;t++)s.push(t);else if(n<=3){for(let t=1;t<=4;t++)s.push(t);s.push("..."),s.push(r)}else if(n>=r-2){s.push(1),s.push("...");for(let t=r-3;t<=r;t++)s.push(t)}else{s.push(1),s.push("...");for(let t=n-1;t<=n+1;t++)s.push(t);s.push("..."),s.push(r)}return s},[n,r]);return e.jsxs("div",{className:"user-my-files-component my-files-wrapper",children:[e.jsx("div",{className:"my-files-header-top",children:x?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"header-left",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"32px",width:"140px",marginBottom:"12px",borderRadius:"8px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"18px",width:"200px",borderRadius:"6px"}})]}),e.jsxs("div",{className:"stats-row",children:[e.jsxs("div",{className:"stat-box-skeleton",children:[e.jsx("div",{className:"skeleton-circle",style:{width:"56px",height:"56px"}}),e.jsxs("div",{className:"stat-text-skeleton",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"28px",width:"40px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"14px",width:"140px",borderRadius:"6px"}})]})]}),e.jsxs("div",{className:"stat-box-skeleton",children:[e.jsx("div",{className:"skeleton-circle",style:{width:"56px",height:"56px"}}),e.jsxs("div",{className:"stat-text-skeleton",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"28px",width:"40px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"14px",width:"140px",borderRadius:"6px"}})]})]}),e.jsxs("div",{className:"stat-box-skeleton",children:[e.jsx("div",{className:"skeleton-circle",style:{width:"56px",height:"56px"}}),e.jsxs("div",{className:"stat-text-skeleton",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"28px",width:"40px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"14px",width:"140px",borderRadius:"6px"}})]})]}),e.jsxs("div",{className:"stat-box-skeleton",children:[e.jsx("div",{className:"skeleton-circle",style:{width:"56px",height:"56px"}}),e.jsxs("div",{className:"stat-text-skeleton",children:[e.jsx("div",{className:"skeleton-box-inline",style:{height:"28px",width:"40px",marginBottom:"8px",borderRadius:"6px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{height:"14px",width:"140px",borderRadius:"6px"}})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{children:"My Files"}),e.jsxs("p",{className:"header-subtitle",children:[l.length," files â€¢ ",p(S)," total"]})]}),e.jsxs("div",{className:"stats-row",children:[e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-icon",children:"TL"}),e.jsxs("div",{className:"stat-text",children:[e.jsx("div",{className:"stat-number",children:w.filter(s=>s.status==="uploaded").length}),e.jsx("div",{className:"stat-name",children:"Pending Team Leader"})]})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-icon",children:"AD"}),e.jsxs("div",{className:"stat-text",children:[e.jsx("div",{className:"stat-number",children:w.filter(s=>s.status==="team_leader_approved").length}),e.jsx("div",{className:"stat-name",children:"Pending Admin"})]})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-icon",children:"AP"}),e.jsxs("div",{className:"stat-text",children:[e.jsx("div",{className:"stat-number",children:R.length}),e.jsx("div",{className:"stat-name",children:"Approved Files"})]})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-icon",children:"RE"}),e.jsxs("div",{className:"stat-text",children:[e.jsx("div",{className:"stat-number",children:M.length}),e.jsx("div",{className:"stat-name",children:"Rejected Files"})]})]})]})]})}),e.jsx("div",{className:"files-table-wrapper",children:l.length>0?e.jsxs("div",{className:"files-list",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("div",{className:"col-filename",children:"FILENAME"}),e.jsx("div",{className:"col-datetime",children:"DATE & TIME"}),e.jsx("div",{className:"col-team",children:"TEAM"}),e.jsx("div",{className:"col-status",children:"STATUS"})]}),E.map(s=>{const{date:i,time:t}=T(s.uploaded_at);return e.jsxs("div",{className:"file-row-new",onClick:h=>P(s,h),title:"Double click to open file",children:[e.jsxs("div",{className:"col-filename",children:[e.jsx(L,{fileType:s.original_name.split(".").pop().toLowerCase(),isFolder:!1,size:"default",altText:`${s.file_type} file`,style:{width:"44px",height:"44px"}}),e.jsxs("div",{className:"file-text",children:[e.jsx("div",{className:"filename",children:s.original_name}),e.jsx("div",{className:"filesize",children:p(s.file_size)}),e.jsxs("div",{className:"datetime-mobile",children:[e.jsx("div",{className:"date-label",children:i}),e.jsx("div",{className:"time-label",children:t})]})]})]}),e.jsxs("div",{className:"col-datetime",children:[e.jsx("div",{className:"date-label",children:i}),e.jsx("div",{className:"time-label",children:t})]}),e.jsx("div",{className:"col-team",children:e.jsx("span",{className:"team-text",children:s.user_team})}),e.jsx("div",{className:"col-status",children:e.jsx("span",{className:`status-tag ${F(s.status)}`,children:C(s.status)})})]},s.id)})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“‹"}),e.jsx("h3",{children:"No files found"}),e.jsx("p",{children:m.length===0?"Ready to upload your first file? Click the button above to get started.":"No files match your current search criteria."})]})}),l.length>0&&e.jsxs("div",{className:"pagination-wrapper",children:[e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"pagination-text",children:["Showing ",(n-1)*c+1," to ",Math.min(n*c,l.length)," of ",l.length," files"]}),e.jsxs("div",{className:"items-per-page",children:[e.jsx("label",{htmlFor:"itemsPerPage",children:"Show:"}),e.jsxs("select",{id:"itemsPerPage",value:c,onChange:A,className:"items-select",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]}),e.jsxs("div",{className:"pagination-controls",children:[e.jsx("button",{className:"pagination-btn pagination-prev",onClick:()=>N(n-1),disabled:n===1,title:"Previous page",children:e.jsx("span",{children:"â€¹"})}),I().map((s,i)=>s==="..."?e.jsx("span",{className:"pagination-ellipsis",children:"..."},`ellipsis-${i}`):e.jsx("button",{className:`pagination-btn pagination-number ${n===s?"active":""}`,onClick:()=>N(s),children:s},s)),e.jsx("button",{className:"pagination-btn pagination-next",onClick:()=>N(n+1),disabled:n===r,title:"Next page",children:e.jsx("span",{children:"â€º"})})]})]}),e.jsx($,{isOpen:o.isOpen,onClose:()=>g({...o,isOpen:!1}),title:o.title,message:o.message,type:o.type})]})};export{z as default};
