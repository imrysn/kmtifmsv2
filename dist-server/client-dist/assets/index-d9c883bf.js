import{j as e,u as Ne,L as le,a as ne,F as ie,C as fe,g as re}from"./index-ea7f734c.js";import{A as Ve,N as He,S as Oe}from"./index-ea7f734c.js";import{r as j,b as H}from"./react-vendor-a308f804.js";import"./router-vendor-90630356.js";import"./anime-vendor-37453147.js";const ke=({toggleSidebar:g,searchQuery:c,setSearchQuery:t})=>e.jsxs("header",{className:"tl-top-bar",children:[e.jsxs("button",{className:"tl-hamburger",onClick:g,children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsxs("div",{className:"tl-search",children:[e.jsxs("svg",{className:"tl-search-icon",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[e.jsx("path",{d:"M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M19 19L14.65 14.65",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("input",{type:"text",placeholder:"Search here...",value:c,onChange:o=>t(o.target.value)})]})]}),we=({userId:g,onNotificationClick:c})=>{const[t,o]=j.useState(0),[v,y]=j.useState(!1);Ne(t),j.useEffect(()=>{d();const x=setInterval(d,3e4);return()=>clearInterval(x)},[g]);const d=async()=>{try{const p=await(await fetch(`http://localhost:3001/api/notifications/user/${g}/unread-count`)).json();if(p.success){const m=p.count||0;m>t&&(y(!0),setTimeout(()=>y(!1),1e3)),o(m)}}catch(x){console.error("Error fetching unread count:",x)}};return e.jsxs("button",{className:`tl-notification-bell ${v?"pulse":""}`,onClick:c,title:"Notifications",children:[e.jsx("span",{className:"tl-bell-icon",children:"ðŸ””"}),t>0&&e.jsx("span",{className:"tl-unread-badge",children:t>99?"99+":t})]})},De=({pendingFiles:g,teamMembers:c,calculateApprovalRate:t,submittedFiles:o=[],assignments:v=[],notifications:y=[],notificationCounts:d={overdue:0,urgent:0,pending:0},analyticsData:x=null,activeTab:p,setActiveTab:m,onNavigateToTask:S,isLoading:P=!1})=>{if(P)return e.jsxs("div",{className:"tl-content",children:[e.jsxs("div",{className:"tl-dashboard-header",children:[e.jsx("h1",{children:"Dashboard"}),e.jsx("p",{children:"Comprehensive overview of team activities and performance"})]}),e.jsx("div",{className:"tl-dashboard-actions",children:e.jsx(le,{count:4})}),e.jsx("div",{className:"tl-dashboard-grid",children:e.jsx(le,{count:6})})]});const R=()=>{const i=o.length,f=o.filter(_=>_.status==="approved"||_.status==="final_approved").length,w=o.filter(_=>_.status==="rejected"||_.status==="rejected_by_team_leader"||_.status==="rejected_by_admin").length,D=i-f-w;return{total:i,approved:f,rejected:w,pending:D}},A=()=>{const i=v.filter(D=>D.status==="active").length,f=v.reduce((D,_)=>D+(_.submission_count||0),0),w=v.filter(D=>{if(!D.due_date)return!1;const _=new Date(D.due_date),T=Math.ceil((_-new Date)/(1e3*60*60*24));return T>=0&&T<=7}).length;return{activeAssignments:i,totalSubmissions:f,upcomingDue:w}},$=()=>{const i=new Date,w=v.filter(a=>a.status==="active"&&a.due_date).map(a=>{const b=new Date(a.due_date),V=Math.ceil((b-i)/(1e3*60*60*24));return{...a,daysUntilDue:V,dueDate:b}}).sort((a,b)=>a.dueDate-b.dueDate),D=w.filter(a=>a.daysUntilDue<0),_=w.filter(a=>a.daysUntilDue===0),W=w.filter(a=>a.daysUntilDue>0&&a.daysUntilDue<=7),T=w.filter(a=>a.daysUntilDue>7);return[...D,..._,...W,...T].slice(0,6)},k=R(),B=A(),N=$();return e.jsxs("div",{className:"tl-content",children:[e.jsxs("div",{className:"tl-dashboard-header",children:[e.jsx("h1",{children:"Dashboard"}),e.jsx("p",{children:"Comprehensive overview of team activities and performance"})]}),e.jsxs("div",{className:"tl-dashboard-grid",children:[e.jsxs("div",{className:"tl-dashboard-card",children:[e.jsxs("div",{className:"tl-card-header",children:[e.jsx("h3",{children:"File Collection"}),e.jsx("div",{className:"tl-card-icon",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})})})]}),e.jsxs("div",{className:"tl-card-stats",children:[e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value",children:k.total}),e.jsx("span",{className:"tl-stat-label",children:"Total Submissions"})]}),e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value green",children:k.approved}),e.jsx("span",{className:"tl-stat-label",children:"Approved"})]}),e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value orange",children:k.pending}),e.jsx("span",{className:"tl-stat-label",children:"Pending"})]}),e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value red",children:k.rejected}),e.jsx("span",{className:"tl-stat-label",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"tl-dashboard-card",children:[e.jsxs("div",{className:"tl-card-header",children:[e.jsx("h3",{children:"Tasks"}),e.jsx("div",{className:"tl-card-icon",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M9 11l3 3L22 4"}),e.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]})})]}),e.jsxs("div",{className:"tl-card-stats",children:[e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value",children:B.activeAssignments}),e.jsx("span",{className:"tl-stat-label",children:"Active Tasks"})]}),e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value",children:B.totalSubmissions}),e.jsx("span",{className:"tl-stat-label",children:"Total Submissions"})]}),e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value warning",children:B.upcomingDue}),e.jsx("span",{className:"tl-stat-label",children:"Due This Week"})]})]})]}),e.jsxs("div",{className:"tl-dashboard-card",children:[e.jsxs("div",{className:"tl-card-header",children:[e.jsx("h3",{children:"Team Management"}),e.jsx("div",{className:"tl-card-icon",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})})]}),e.jsxs("div",{className:"tl-card-stats",children:[e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value",children:c.length}),e.jsx("span",{className:"tl-stat-label",children:"Total Members"})]}),e.jsxs("div",{className:"tl-stat-item",children:[e.jsxs("span",{className:"tl-stat-value",children:[t(),"%"]}),e.jsx("span",{className:"tl-stat-label",children:"Approval Rate"})]}),e.jsxs("div",{className:"tl-stat-item",children:[e.jsx("span",{className:"tl-stat-value",children:g.length}),e.jsx("span",{className:"tl-stat-label",children:"Files Pending"})]})]})]}),e.jsxs("div",{className:"tl-dashboard-card large",children:[e.jsxs("div",{className:"tl-card-header",children:[e.jsx("h3",{children:"Recent Activity"}),e.jsx("div",{className:"tl-card-icon",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})})]}),e.jsxs("div",{className:"tl-activity-list",children:[o.slice(0,5).map((i,f)=>e.jsxs("div",{className:"tl-activity-item",children:[e.jsx("div",{className:"tl-activity-icon",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})})}),e.jsxs("div",{className:"tl-activity-content",children:[e.jsx("div",{className:"tl-activity-title",children:i.original_name}),e.jsxs("div",{className:"tl-activity-meta",children:[i.assignment_title?`Assignment: ${i.assignment_title}`:"Direct upload"," â€¢",i.username||i.fullName," â€¢",new Date(i.submitted_at||i.uploaded_at).toLocaleDateString()]})]}),e.jsx("span",{className:`status-badge status-${i.status==="approved"||i.status==="final_approved"?"approved":i.status==="rejected"||i.status==="rejected_by_team_leader"||i.status==="rejected_by_admin"?"rejected":"pending"}`,children:i.status==="approved"||i.status==="final_approved"?"Approved":i.status==="rejected"||i.status==="rejected_by_team_leader"||i.status==="rejected_by_admin"?"Rejected":i.status==="team_leader_approved"?"Pending Admin":"Pending Team Leader"})]},i.id)),o.length===0&&e.jsxs("div",{className:"tl-activity-empty",children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",opacity:"0.3",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]}),e.jsx("p",{children:"No recent activity"})]})]})]}),e.jsxs("div",{className:"tl-dashboard-card tall",children:[e.jsxs("div",{className:"tl-card-header",children:[e.jsx("h3",{children:"Priority Items"}),e.jsx("div",{className:"tl-card-icon",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"4"})]})})]}),e.jsx("div",{className:"tl-priority-list",children:N.length>0?N.map(i=>{const f=i.daysUntilDue<0,w=i.daysUntilDue===0,D=i.daysUntilDue>0&&i.daysUntilDue<=7;return e.jsxs("div",{className:`tl-priority-item ${f?"overdue":w?"urgent":D?"due-soon":""}`,onClick:()=>S&&S(i.id),style:{cursor:"pointer"},children:[e.jsx("div",{className:"tl-priority-icon",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f?e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"16"})]}):e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12,6 12,12 16,14"})]})})}),e.jsx("div",{className:"tl-priority-content",children:e.jsx("span",{className:"tl-priority-label",children:i.title})}),e.jsx("span",{className:"tl-priority-count",children:f?`${Math.abs(i.daysUntilDue)}d overdue`:w?"Due today":`${i.daysUntilDue}d left`})]},i.id)}):e.jsxs("div",{className:"tl-priority-empty",children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",opacity:"0.3",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9 12l2 2 4-4"})]}),e.jsx("p",{children:"No upcoming deadlines"})]})})]})]})]})},Te=({submittedFiles:g,isLoading:c,openFileViewModal:t,formatFileSize:o,user:v,openMenuId:y,toggleMenu:d,handleOpenInExplorer:x,fileCollectionFilter:p,setFileCollectionFilter:m,fileCollectionSort:S,setFileCollectionSort:P,onNavigateToTask:R,highlightedFileId:A,onClearFileHighlight:$})=>{const[k,B]=j.useState(""),[N,i]=j.useState(1),[f]=j.useState(7);j.useEffect(()=>{i(1)},[k,p,S]),j.useEffect(()=>{A&&g.length>0&&setTimeout(()=>{const l=document.querySelector(`tr[data-file-id="${A}"]`);l&&(l.scrollIntoView({behavior:"smooth",block:"center"}),l.classList.add("tl-file-highlighted"),setTimeout(()=>{l.classList.remove("tl-file-highlighted"),$&&$()},1500))},300)},[A,g]);const w=(l,E)=>{if(l){const h=l.split(".");if(h.length>1)return h[h.length-1].toLowerCase()}return E?E.replace(/^\./,"").toLowerCase():""},_=(()=>{const l=g.length,E=g.filter(M=>M.status==="approved"||M.status==="final_approved").length,h=g.filter(M=>M.status==="rejected"||M.status==="rejected_by_team_leader"||M.status==="rejected_by_admin").length,C=l-E-h;return{total:l,approved:E,rejected:h,pending:C}})(),T=(()=>{let l=g;if(k.trim()){const h=k.toLowerCase();l=l.filter(C=>C.original_name?.toLowerCase().includes(h)||C.username?.toLowerCase().includes(h)||C.fullName?.toLowerCase().includes(h)||C.team?.toLowerCase().includes(h)||C.assignment_title?.toLowerCase().includes(h))}return p!=="all"&&(l=l.filter(h=>{switch(p){case"pending":return h.status==="uploaded"||h.status==="team_leader_approved";case"approved":return h.status==="final_approved"||h.status==="approved";case"rejected":return h.status==="rejected_by_team_leader"||h.status==="rejected_by_admin"||h.status==="rejected";default:return!0}})),[...l].sort((h,C)=>{switch(S){case"date-desc":return new Date(C.submitted_at||C.uploaded_at)-new Date(h.submitted_at||h.uploaded_at);case"date-asc":return new Date(h.submitted_at||h.uploaded_at)-new Date(C.submitted_at||C.uploaded_at);case"filename-asc":return h.original_name.localeCompare(C.original_name);case"filename-desc":return C.original_name.localeCompare(h.original_name);case"user-asc":return(h.username||"").localeCompare(C.username||"");case"user-desc":return(C.username||"").localeCompare(h.username||"");default:return 0}})})(),a=j.useMemo(()=>{const l=(N-1)*f,E=l+f;return T.slice(l,E)},[T,N,f]),b=j.useMemo(()=>Math.ceil(T.length/f),[T.length,f]),V=j.useMemo(()=>{const l=[];if(b<=5)for(let h=1;h<=b;h++)l.push(e.jsx("button",{className:`pagination-btn ${h===N?"active":""}`,onClick:()=>i(h),children:h},h));else{l.push(e.jsx("button",{className:`pagination-btn ${N===1?"active":""}`,onClick:()=>i(1),children:"1"},1)),N>3&&l.push(e.jsx("span",{className:"pagination-ellipsis",children:"..."},"ellipsis1"));const h=Math.max(2,N-1),C=Math.min(b-1,N+1);for(let M=h;M<=C;M++)M!==1&&M!==b&&l.push(e.jsx("button",{className:`pagination-btn ${M===N?"active":""}`,onClick:()=>i(M),children:M},M));N<b-2&&l.push(e.jsx("span",{className:"pagination-ellipsis",children:"..."},"ellipsis2")),b>1&&l.push(e.jsx("button",{className:`pagination-btn ${b===N?"active":""}`,onClick:()=>i(b),children:b},b))}return l},[b,N]);return e.jsxs("div",{className:"tl-content",children:[e.jsxs("div",{className:"tl-page-header-with-stats",children:[e.jsxs("div",{className:"tl-page-header",children:[e.jsx("h1",{children:"File Collection"}),e.jsx("p",{children:"View all submitted files from assignments in one place"})]}),e.jsxs("div",{className:"file-status-cards",children:[e.jsxs("div",{className:"file-status-card",children:[e.jsx("div",{className:"status-icon total-icon",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("div",{className:"status-info",children:[e.jsx("div",{className:"status-number",children:_.total}),e.jsx("div",{className:"status-label",children:"Total Submissions"})]})]}),e.jsxs("div",{className:"file-status-card",children:[e.jsx("div",{className:"status-icon pending-icon",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("div",{className:"status-info",children:[e.jsx("div",{className:"status-number",children:_.pending}),e.jsx("div",{className:"status-label",children:"Pending Review"})]})]}),e.jsxs("div",{className:"file-status-card",children:[e.jsx("div",{className:"status-icon approved-icon",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("div",{className:"status-info",children:[e.jsx("div",{className:"status-number",children:_.approved}),e.jsx("div",{className:"status-label",children:"Approved"})]})]}),e.jsxs("div",{className:"file-status-card",children:[e.jsx("div",{className:"status-icon rejected-icon",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("div",{className:"status-info",children:[e.jsx("div",{className:"status-number",children:_.rejected}),e.jsx("div",{className:"status-label",children:"Rejected"})]})]})]})]}),e.jsxs("div",{className:"file-controls",children:[e.jsx("div",{className:"file-search",children:e.jsx("input",{type:"text",placeholder:"Search files by name, user, or team...",className:"search-input",value:k,onChange:l=>B(l.target.value)})}),e.jsxs("div",{className:"file-filters",children:[e.jsxs("select",{value:p,onChange:l=>m(l.target.value),className:"form-select",children:[e.jsx("option",{value:"all",children:"All Files"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("select",{value:S,onChange:l=>P(l.target.value),className:"form-select",children:[e.jsx("option",{value:"date-desc",children:"Latest First"}),e.jsx("option",{value:"date-asc",children:"Oldest First"}),e.jsx("option",{value:"filename-asc",children:"Filename A-Z"}),e.jsx("option",{value:"filename-desc",children:"Filename Z-A"}),e.jsx("option",{value:"user-asc",children:"User A-Z"}),e.jsx("option",{value:"user-desc",children:"User Z-A"})]})]})]}),c?e.jsx("div",{className:"tl-files-list",children:e.jsx(ne,{rows:8,columns:6})}):a.length>0?e.jsxs("div",{className:"tl-files-list",children:[e.jsxs("table",{className:"tl-files-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"File Name"}),e.jsx("th",{children:"Assignment"}),e.jsx("th",{children:"Submitted By"}),e.jsx("th",{children:"Submitted Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"80px",textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:a.map(l=>{const E=w(l.original_name,l.file_type);return e.jsxs("tr",{"data-file-id":l.id,className:"tl-clickable-row",onClick:()=>t(l),children:[e.jsx("td",{children:e.jsxs("div",{className:"file-cell",children:[e.jsx("div",{className:"file-icon",children:e.jsx(ie,{fileType:E,isFolder:!1,altText:`Icon for ${l.original_name}`,size:"medium"})}),e.jsxs("div",{className:"file-details",children:[e.jsx("span",{className:"file-name",children:l.original_name}),e.jsx("span",{className:"file-size",children:o(l.file_size)})]})]})}),e.jsx("td",{children:e.jsxs("div",{className:"assignment-cell",children:[e.jsx("span",{className:"assignment-title",children:l.assignment_title}),l.assignment_due_date&&e.jsxs("span",{className:"assignment-due-date",children:["Due: ",new Date(l.assignment_due_date).toLocaleDateString()]})]})}),e.jsx("td",{children:e.jsx("div",{className:"user-cell",children:e.jsx("span",{className:"user-name",children:l.fullName||l.username})})}),e.jsx("td",{children:e.jsxs("div",{className:"datetime-cell",children:[e.jsx("div",{className:"date",children:new Date(l.submitted_at||l.uploaded_at).toLocaleDateString()}),e.jsx("div",{className:"time",children:new Date(l.submitted_at||l.uploaded_at).toLocaleTimeString()})]})}),e.jsx("td",{children:e.jsx("span",{className:`status-badge status-${l.status==="approved"||l.status==="final_approved"?"approved":l.status==="rejected"||l.status==="rejected_by_team_leader"||l.status==="rejected_by_admin"?"rejected":"pending"}`,children:l.status==="approved"||l.status==="final_approved"?"Approved":l.status==="rejected"||l.status==="rejected_by_team_leader"||l.status==="rejected_by_admin"?"Rejected":l.status==="team_leader_approved"?"Pending Admin":"Pending Team Leader"})}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{className:"tl-actions-menu-wrapper",children:[e.jsx("button",{className:"tl-menu-button",onClick:h=>d(l.id,h),title:"Options",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[e.jsx("circle",{cx:"3",cy:"8",r:"1.5",fill:"currentColor"}),e.jsx("circle",{cx:"8",cy:"8",r:"1.5",fill:"currentColor"}),e.jsx("circle",{cx:"13",cy:"8",r:"1.5",fill:"currentColor"})]})}),y===l.id&&e.jsx("div",{className:"tl-dropdown-menu",children:l.assignment_id&&R&&e.jsxs("button",{className:"tl-dropdown-item",onClick:h=>{h.stopPropagation(),R(l.assignment_id,l.id)},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[e.jsx("path",{d:"M5.33333 2.66667H2.66667C2.29848 2.66667 2 2.96514 2 3.33333V13.3333C2 13.7015 2.29848 14 2.66667 14H12.6667C13.0349 14 13.3333 13.7015 13.3333 13.3333V10.6667",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 2L14 4L8.66667 9.33333L6.66667 9.66667L7 7.66667L12 2Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Go to Task"]})})]})})]},l.id)})})]}),!c&&T.length>0&&e.jsxs("div",{className:"pagination-section",children:[e.jsxs("div",{className:"pagination-info",children:["Showing ",(N-1)*f+1," to ",Math.min(N*f,T.length)," of ",T.length," files"]}),b>1&&e.jsxs("div",{className:"pagination-controls",children:[e.jsx("button",{className:"pagination-btn",onClick:()=>i(l=>Math.max(l-1,1)),disabled:N===1,children:"â€¹"}),V,e.jsx("button",{className:"pagination-btn",onClick:()=>i(l=>Math.min(l+1,b)),disabled:N===b,children:"â€º"})]})]})]}):e.jsxs("div",{className:"tl-empty",children:[e.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",style:{marginBottom:"16px",opacity:.3},children:[e.jsx("path",{d:"M24 16H13.3333C11.4924 16 10 17.4924 10 19.3333V50.6667C10 52.5076 11.4924 54 13.3333 54H50.6667C52.5076 54 54 52.5076 54 50.6667V19.3333C54 17.4924 52.5076 16 50.6667 16H40",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M40 10H24V22H40V10Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M32 32V42M32 42L37 37M32 42L27 37",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("h3",{children:"No submissions yet"}),e.jsx("p",{children:"Assignment submissions from your team will appear here"})]})]})},Me=({isLoadingTeam:g,teamMembers:c,fetchMemberFiles:t})=>e.jsxs("div",{className:"tl-content",children:[e.jsxs("div",{className:"tl-page-header",children:[e.jsx("h1",{children:"Team Management"}),e.jsx("p",{children:"Manage your team members and their activity"})]}),g?e.jsxs("div",{className:"tl-table-container",children:[e.jsx("div",{className:"tl-table-header",children:e.jsx("h2",{children:"Team Members"})}),e.jsx(ne,{rows:6,columns:6})]}):c.length>0?e.jsxs("div",{className:"tl-table-container",children:[e.jsx("div",{className:"tl-table-header",children:e.jsxs("h2",{children:["Team Members (",c.length,")"]})}),e.jsxs("table",{className:"tl-table tl-team-members-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"NAME"}),e.jsx("th",{children:"EMAIL"}),e.jsx("th",{children:"JOINED"}),e.jsx("th",{children:"FILES"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{style:{textAlign:"center"},children:"ACTIONS"})]})}),e.jsx("tbody",{children:c.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:o.name})}),e.jsx("td",{style:{color:"var(--text-secondary)"},children:o.email}),e.jsx("td",{style:{color:"var(--text-secondary)"},children:o.joined}),e.jsx("td",{children:e.jsxs("span",{className:"tl-badge",style:{background:"#E0E7FF",color:"var(--primary-color)"},children:[o.files," files"]})}),e.jsx("td",{children:e.jsx("span",{className:`tl-badge ${o.status.toLowerCase()}`,children:o.status})}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("button",{className:"tl-btn secondary",onClick:()=>t(o.id,o.name),title:"View member files",style:{padding:"0.5rem 1rem",fontSize:"14px"},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M9 5H7C6.46957 5 5.96086 5.21071 5.58579 5.58579C5.21071 5.96086 5 6.46957 5 7V19C5 19.5304 5.21071 20.0391 5.58579 20.4142C5.96086 20.7893 6.46957 21 7 21H17C17.5304 21 18.0391 20.7893 18.4142 20.4142C18.7893 20.0391 19 19.5304 19 19V7C19 6.46957 18.7893 5.96086 18.4142 5.58579C18.0391 5.21071 17.5304 5 17 5H15M9 5C9 5.53043 9.21071 6.03914 9.58579 6.41421C9.96086 6.78929 10.4696 7 11 7H13C13.5304 7 14.0391 6.78929 14.4142 6.41421C14.7893 6.03914 15 5.53043 15 5M9 5C9 4.46957 9.21071 3.96086 9.58579 3.58579C9.96086 3.21071 10.4696 3 11 3H13C13.5304 3 14.0391 3.21071 14.4142 3.58579C14.7893 3.96086 15 4.46957 15 5M12 12H15M12 16H15M9 12H9.01M9 16H9.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"View Files"]})})]},o.id))})]})]}):e.jsxs("div",{className:"tl-empty",children:[e.jsx("h3",{children:"No team members"}),e.jsx("p",{children:"Your team currently has no members."})]})]}),Le=({isLoadingAssignments:g,assignments:c,formatDate:t,deleteAssignment:o,setShowCreateAssignmentModal:v,openReviewModal:y,user:d,notificationCommentContext:x,onClearNotificationContext:p,highlightedAssignmentId:m,onClearHighlight:S,highlightedFileId:P,onClearFileHighlight:R})=>{const[A,$]=j.useState(!1),[k,B]=j.useState([]),[N,i]=j.useState({}),[f,w]=j.useState({}),[D,_]=j.useState({}),[W,T]=j.useState(!1),[a,b]=j.useState(null),[V,l]=j.useState({}),[E,h]=j.useState({}),[C,M]=j.useState({}),[Q,X]=j.useState({}),[z,Z]=j.useState(null),[de,J]=j.useState(!1),[q,Y]=j.useState(null),[F,ce]=j.useState({}),K=j.useRef(!1);j.useEffect(()=>{c.forEach(s=>{G(s.id)})},[c]),j.useEffect(()=>{if(console.log("ðŸ’¬ AssignmentsTab: notificationCommentContext changed:",x),console.log("   Assignments length:",c.length),x&&c.length>0){console.log("   ðŸ” Looking for assignment ID:",x.assignmentId);const s=c.find(n=>n.id===x.assignmentId);s?(console.log("   âœ… Found assignment:",s.title),console.log("   ðŸ’¡ Opening comments modal..."),x.expandAllReplies&&(K.current=!0,console.log("   ðŸ“Œ Reply notification detected - will expand after modal opens")),te(s),setTimeout(()=>{p&&(console.log("   ðŸ§¹ Clearing notification context"),p())},100)):(console.log("   âŒ Assignment not found!"),console.log("   Available assignment IDs:",c.map(n=>n.id)))}else x||console.log("   âš ï¸ No notificationCommentContext"),c.length===0&&console.log("   âš ï¸ No assignments loaded yet")},[x,c]),j.useEffect(()=>{W&&a&&K.current&&(console.log("   ðŸ”“ Modal is open, expanding all replies..."),setTimeout(()=>{const s=N[a.id]||[];if(console.log("   ðŸ“Š Found",s.length,"comments"),s.length>0){const n={};let r=null;s.forEach(u=>{u.replies&&u.replies.length>0&&(n[u.id]=!0,r||(r=u.id))}),console.log("   âœ… Expanding replies for comments:",Object.keys(n)),X(u=>({...u,...n})),r&&setTimeout(()=>{const u=document.querySelector(`[data-comment-id="${r}"]`);if(u){console.log("   ðŸ“œ Scrolling to comment:",r),u.scrollIntoView({behavior:"smooth",block:"center"});const L=u.querySelector(".tl-comment-bubble");L&&(L.classList.add("tl-comment-highlighted"),setTimeout(()=>{L.classList.remove("tl-comment-highlighted")},2e3))}},400)}K.current=!1},500))},[W,a,N]),j.useEffect(()=>{const s=n=>{z&&!n.target.closest(".tl-assignment-card-menu")&&Z(null)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[z]),j.useEffect(()=>{m&&c.length>0&&setTimeout(()=>{const s=document.getElementById(`assignment-card-${m}`);s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),s.classList.add("tl-assignment-highlighted"),setTimeout(()=>{s.classList.remove("tl-assignment-highlighted"),S&&S()},1500))},300)},[m,c]),j.useEffect(()=>{P&&m&&c.length>0&&setTimeout(()=>{const s=document.querySelector(`[data-file-id="${P}"]`);s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),s.classList.add("tl-assignment-file-highlighted"),setTimeout(()=>{s.classList.remove("tl-assignment-file-highlighted"),R&&R()},1500))},1e3)},[P,m,c]);const G=async s=>{try{console.log(`ðŸ” Fetching comments for assignment ${s}`);const r=await(await fetch(`http://localhost:3001/api/assignments/${s}/comments`)).json();console.log(`ðŸ’¬ Comments response for ${s}:`,r),r.success?(console.log(`âœ… Setting ${r.comments?.length||0} comments for assignment ${s}`),i(u=>({...u,[s]:r.comments||[]}))):console.log(`âŒ Failed to fetch comments for assignment ${s}`)}catch(n){console.error("Error fetching comments:",n)}},ee=async s=>{const n=f[s]?.trim();if(n){_(r=>({...r,[s]:!0}));try{(await(await fetch(`http://localhost:3001/api/assignments/${s}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d.id,username:d.username||d.fullName,comment:n})})).json()).success&&(w(L=>({...L,[s]:""})),G(s))}catch(r){console.error("Error posting comment:",r)}finally{_(r=>({...r,[s]:!1}))}}},se=async(s,n)=>{const r=E[n]?.trim();if(r){M(u=>({...u,[n]:!0}));try{(await(await fetch(`http://localhost:3001/api/assignments/${s}/comments/${n}/reply`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d.id,username:d.username||d.fullName,reply:r})})).json()).success&&(h(U=>({...U,[n]:""})),l(U=>({...U,[n]:!1})),G(s))}catch(u){console.error("Error posting reply:",u)}finally{M(u=>({...u,[n]:!1}))}}},oe=s=>{l(n=>({...n,[s]:!n[s]}))},he=s=>{X(n=>({...n,[s]:!n[s]}))},te=s=>{b(s),T(!0)},me=s=>{ce(n=>({...n,[s]:!n[s]}))},ae=s=>{const n=new Date(s),u=Math.floor((new Date-n)/1e3);return u<60?"Just now":u<3600?`${Math.floor(u/60)}m ago`:u<86400?`${Math.floor(u/3600)}h ago`:u<604800?`${Math.floor(u/86400)}d ago`:u<2592e3?`${Math.floor(u/604800)}w ago`:t(s)},ue=s=>s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown",pe=s=>{if(!s)return"";const u=new Date(s)-new Date,L=Math.ceil(u/(1e3*60*60*24));return L<0?`${Math.abs(L)} days overdue`:L===0?"Due today":L===1?"1 day left":`${L} days left`},xe=s=>{if(!s)return"#95a5a6";const n=new Date(s),u=Math.ceil((n-new Date)/(1e3*60*60*24));return u<0?"#e74c3c":u<=2?"#f39c12":"#27ae60"},je=s=>{if((s.assigned_to||s.assignedTo)==="all")return e.jsx("span",{className:"tl-assignment-assigned-user",children:"All team members"});const r=s.assigned_member_details||[],u=r.length;if(u===0)return e.jsx("span",{className:"tl-assignment-assigned-user",children:"No members assigned"});if(u===1)return e.jsx("span",{className:"tl-assignment-assigned-user",children:r[0].fullName||r[0].username});if(u<=4){const L=r.map(U=>U.fullName||U.username).join(", ");return e.jsx("span",{className:"tl-assignment-assigned-user",children:L})}else{const L=r.slice(0,4),U=r.slice(4),ve=L.map(I=>I.fullName||I.username).join(", "),ge=U.map(I=>I.fullName||I.username).join(", ");return e.jsxs("span",{className:"tl-assignment-assigned-user",children:[ve,e.jsxs("span",{className:"tl-assignment-more-members","data-tooltip":ge,children:[" ","+",U.length," more"]})]})}},O=s=>{if(!s)return"TL";if(s.includes(".")){const r=s.split(".");if(r.length>=2)return(r[0][0]+r[1][0]).toUpperCase()}const n=s.split(" ");return n.length>=2?(n[0][0]+n[1][0]).toUpperCase():s.substring(0,2).toUpperCase()};return g?e.jsx("div",{className:"tl-content",children:e.jsxs("div",{className:"tl-assignments-feed",children:[e.jsxs("div",{className:"tl-page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Tasks"}),e.jsx("p",{children:"Manage team tasks and submissions"})]}),e.jsxs("button",{className:"tl-btn success",onClick:()=>v(!0),children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M10 4V16M4 10H16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Create Task"]})]}),e.jsx("div",{className:"tl-assignments-feed-container",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"tl-assignment-card",children:[e.jsxs("div",{className:"tl-assignment-card-header",children:[e.jsxs("div",{className:"tl-assignment-header-left",children:[e.jsx("div",{className:"tl-assignment-avatar",children:e.jsx("div",{className:"skeleton-box-inline",style:{width:"32px",height:"32px",borderRadius:"50%"}})}),e.jsxs("div",{className:"tl-assignment-header-info",children:[e.jsxs("div",{className:"tl-assignment-assigned",children:[e.jsx("div",{className:"skeleton-box-inline",style:{width:"120px",height:"16px",marginBottom:"4px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{width:"80px",height:"14px"}})]}),e.jsx("div",{className:"tl-assignment-created",children:e.jsx("div",{className:"skeleton-box-inline",style:{width:"100px",height:"12px"}})})]})]}),e.jsx("div",{className:"tl-assignment-header-right",children:e.jsx("div",{className:"tl-assignment-due-date",children:e.jsx("div",{className:"skeleton-box-inline",style:{width:"80px",height:"14px"}})})})]}),e.jsx("div",{className:"tl-assignment-task-title-section",children:e.jsx("div",{className:"skeleton-box-inline",style:{width:"200px",height:"20px"}})}),e.jsxs("div",{className:"tl-assignment-task-description-section",children:[e.jsx("div",{className:"skeleton-box-inline",style:{width:"100%",height:"16px",marginBottom:"8px"}}),e.jsx("div",{className:"skeleton-box-inline",style:{width:"80%",height:"16px"}})]}),e.jsx("div",{className:"tl-assignment-attachment-section",children:e.jsxs("div",{className:"tl-assignment-attached-file",children:[e.jsx("div",{className:"tl-assignment-file-label",children:e.jsx("div",{className:"skeleton-box-inline",style:{width:"150px",height:"16px",marginBottom:"12px"}})}),[1,2].map(n=>e.jsxs("div",{className:"tl-assignment-file-item",children:[e.jsx("div",{className:"skeleton-box-inline",style:{width:"24px",height:"24px",borderRadius:"4px",marginRight:"12px"}}),e.jsxs("div",{className:"tl-assignment-file-details",children:[e.jsx("div",{className:"tl-assignment-file-name",children:e.jsx("div",{className:"skeleton-box-inline",style:{width:"120px",height:"16px",marginBottom:"4px"}})}),e.jsx("div",{className:"tl-assignment-file-meta",children:e.jsx("div",{className:"skeleton-box-inline",style:{width:"80px",height:"14px"}})})]})]},n))]})}),e.jsx("div",{className:"tl-assignment-comments-section",children:e.jsx("div",{className:"skeleton-box-inline",style:{width:"100px",height:"16px"}})})]},s))})]})}):e.jsxs("div",{className:"tl-content",children:[e.jsxs("div",{className:"tl-assignments-feed",children:[e.jsxs("div",{className:"tl-page-header",children:[e.jsxs("div",{children:[e.jsxs("h1",{children:["Tasks (",c.length,")"]}),e.jsx("p",{children:"Manage team tasks and submissions"})]}),e.jsxs("button",{className:"tl-btn success",onClick:()=>v(!0),children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M10 4V16M4 10H16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Create Task"]})]}),c.length===0?e.jsxs("div",{className:"tl-assignments-empty",children:[e.jsx("div",{className:"tl-assignments-empty-icon",children:"ðŸ“­"}),e.jsx("h3",{children:"No tasks yet"}),e.jsx("p",{children:"Create a task to get started."}),e.jsx("button",{className:"tl-btn success",onClick:()=>v(!0),children:"Create Your First Task"})]}):e.jsx("div",{className:"tl-assignments-feed-container",children:c.map(s=>{const n=N[s.id]||[];return e.jsxs("div",{id:`assignment-card-${s.id}`,className:"tl-assignment-card",children:[e.jsxs("div",{className:"tl-assignment-card-header",children:[e.jsxs("div",{className:"tl-assignment-header-left",children:[e.jsx("div",{className:"tl-assignment-avatar",children:O(d.fullName||d.username||s.team_leader_fullname||s.team_leader_username)}),e.jsxs("div",{className:"tl-assignment-header-info",children:[e.jsxs("div",{className:"tl-assignment-assigned",children:[e.jsx("span",{className:"tl-assignment-team-leader-name",children:d.fullName||d.username||s.team_leader_fullname||s.team_leader_username}),e.jsx("span",{className:"tl-assignments-role-badge team-leader",children:"TEAM LEADER"}),"assigned to ",je(s)]}),e.jsx("div",{className:"tl-assignment-created",children:ue(s.created_at||s.createdAt)})]})]}),e.jsxs("div",{className:"tl-assignment-header-right",children:[(s.due_date||s.dueDate)&&e.jsxs("div",{className:"tl-assignment-due-date",children:["Due: ",t(s.due_date||s.dueDate),e.jsxs("span",{className:"tl-assignment-days-left",style:{color:xe(s.due_date||s.dueDate)},children:[" ","(",pe(s.due_date||s.dueDate),")"]})]}),e.jsxs("div",{className:"tl-assignment-card-menu",children:[e.jsx("button",{className:"tl-assignment-menu-btn",onClick:()=>Z(z===s.id?null:s.id),title:"More options",children:"â‹®"}),z===s.id&&e.jsx("div",{className:"tl-assignment-menu-dropdown",children:e.jsx("button",{className:"tl-assignment-menu-item tl-assignment-delete-menu-item",onClick:()=>{Y({id:s.id,title:s.title}),J(!0),Z(null)},children:"Delete"})})]})]})]}),e.jsx("div",{className:"tl-assignment-task-title-section",children:e.jsx("h3",{className:"tl-assignment-title",children:s.title})}),s.description?e.jsx("div",{className:"tl-assignment-task-description-section",children:e.jsx("p",{className:"tl-assignment-description",children:s.description})}):e.jsx("div",{className:"tl-assignment-task-description-section",children:e.jsx("p",{className:"tl-assignment-no-description",children:"No description"})}),e.jsx("div",{className:"tl-assignment-attachment-section",children:s.recent_submissions&&s.recent_submissions.length>0?e.jsxs("div",{className:"tl-assignment-attached-file",children:[e.jsxs("div",{className:"tl-assignment-file-label",children:["ðŸ“Ž Submitted Files (",s.recent_submissions.length,")"]}),(F[s.id]?s.recent_submissions:s.recent_submissions.slice(0,5)).map(r=>e.jsxs("div",{"data-file-id":r.id,className:"tl-assignment-file-item",onClick:u=>{u.stopPropagation(),y&&r.id&&y(r,null)},children:[e.jsx(ie,{fileType:(r.original_name||r.file_name).split(".").pop(),size:"small",className:"tl-assignment-file-icon"}),e.jsxs("div",{className:"tl-assignment-file-details",children:[e.jsx("div",{className:"tl-assignment-file-name",children:r.original_name||r.file_name}),e.jsxs("div",{className:"tl-assignment-file-meta",children:[e.jsxs("span",{children:["by ",e.jsx("span",{className:"tl-assignment-file-submitter",children:r.fullName||r.username||"Unknown"})]}),r.tag&&e.jsxs("span",{className:"tl-assignment-file-tag",children:["ðŸ·ï¸ ",r.tag]}),r.description&&e.jsx("span",{className:"tl-assignment-file-description",children:r.description}),e.jsx("span",{className:`tl-assignment-file-status ${r.status==="uploaded"?"uploaded":r.status==="team_leader_approved"?"team-leader-approved":r.status==="final_approved"?"final-approved":r.status==="rejected_by_team_leader"||r.status==="rejected_by_admin"?"rejected":"uploaded"}`,children:r.status==="uploaded"?"NEW":r.status==="team_leader_approved"?"PENDING ADMIN":r.status==="final_approved"?"âœ“ APPROVED":r.status==="rejected_by_team_leader"||r.status==="rejected_by_admin"?"âœ— REJECTED":"PENDING"})]})]})]},r.id)),s.recent_submissions.length>5&&e.jsx("button",{className:"tl-attachment-toggle-btn",onClick:()=>me(s.id),children:F[s.id]?"See less":`See more (${s.recent_submissions.length-5} more)`})]}):e.jsxs("div",{className:"tl-assignment-no-attachment",children:[e.jsx("span",{className:"tl-assignment-no-attachment-icon",children:"â„¹ï¸"}),e.jsxs("div",{className:"tl-assignment-no-attachment-text",children:[e.jsx("strong",{children:"No submissions yet."}),"Waiting for team members to submit files."]})]})}),e.jsx("div",{className:"tl-assignment-comments-section",children:e.jsxs("button",{className:"tl-assignment-comments-text",onClick:()=>te(s),children:["ðŸ’¬ Comments (",n.length,")"]})})]},s.id)})})]}),W&&a&&e.jsx("div",{className:"tl-comments-modal-overlay",onClick:()=>T(!1),children:e.jsxs("div",{className:"tl-comments-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"tl-comments-modal-header",children:[e.jsxs("h3",{children:["Comments - ",a.title]}),e.jsx("button",{className:"tl-comments-modal-close",onClick:()=>T(!1),children:"Ã—"})]}),e.jsx("div",{className:"tl-comments-modal-body",children:e.jsxs("div",{className:"tl-comments-section",children:[N[a.id]?.length>0?e.jsx("div",{className:"tl-comments-list",children:N[a.id].map(s=>e.jsxs("div",{"data-comment-id":s.id,className:"tl-comment-item",children:[e.jsx("div",{className:"tl-comment-avatar",children:O(s.fullName||s.username)}),e.jsxs("div",{className:"tl-comment-content",children:[e.jsxs("div",{className:"tl-comment-bubble",children:[e.jsxs("div",{className:"tl-comment-author",children:[s.fullName||s.username,e.jsx("span",{className:`role-badge ${s.user_role?s.user_role.toLowerCase().replace(" ","-"):"user"}`,children:s.user_role||"USER"})]}),e.jsx("div",{className:"tl-comment-text",children:s.comment})]}),e.jsxs("div",{className:"tl-comment-actions",children:[e.jsx("span",{className:"tl-comment-timestamp",children:ae(s.created_at)}),e.jsx("button",{className:"tl-comment-action-btn",onClick:()=>oe(s.id),children:"Reply"}),s.replies&&s.replies.length>0&&e.jsx("button",{className:"tl-comment-action-btn",onClick:()=>he(s.id),children:Q[s.id]?"Hide replies":`View ${s.replies.length} ${s.replies.length===1?"reply":"replies"}`})]}),Q[s.id]&&s.replies&&s.replies.length>0&&e.jsx("div",{className:"tl-replies-list",children:s.replies.map(n=>e.jsxs("div",{"data-comment-id":n.id,className:"tl-reply-item",children:[e.jsx("div",{className:"tl-comment-avatar tl-reply-avatar",children:O(n.fullName||n.username)}),e.jsxs("div",{className:"tl-comment-content",children:[e.jsxs("div",{className:"tl-comment-bubble",children:[e.jsxs("div",{className:"tl-comment-author",children:[n.fullName||n.username,e.jsx("span",{className:`role-badge ${n.user_role?n.user_role.toLowerCase().replace(" ","-"):"user"}`,children:n.user_role||"USER"})]}),e.jsx("div",{className:"tl-comment-text",children:n.reply})]}),e.jsx("div",{className:"tl-comment-timestamp",children:ae(n.created_at)})]})]},n.id))}),V[s.id]&&e.jsxs("div",{className:"tl-reply-input-box",children:[e.jsx("div",{className:"tl-comment-avatar tl-reply-avatar",children:O(d.username||d.fullName)}),e.jsxs("div",{className:"tl-comment-input-wrapper",children:[e.jsx("input",{type:"text",className:"tl-comment-input",placeholder:"Write a reply...",value:E[s.id]||"",onChange:n=>h(r=>({...r,[s.id]:n.target.value})),onKeyPress:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),se(a.id,s.id))},disabled:C[s.id],autoFocus:!0}),e.jsx("button",{className:"tl-comment-submit-btn",onClick:()=>se(a.id,s.id),disabled:!E[s.id]?.trim()||C[s.id],children:C[s.id]?"...":"âž¤"})]})]})]})]},s.id))}):e.jsxs("div",{className:"tl-comments-no-comments",children:[e.jsx("div",{className:"tl-comments-no-comments-icon",children:"ðŸ’¬"}),e.jsx("p",{children:"No comments yet"}),e.jsx("p",{children:"Be the first to comment on this task"})]}),e.jsxs("div",{className:"tl-add-comment",children:[e.jsx("div",{className:"tl-comment-avatar",children:O(d.username||d.fullName)}),e.jsxs("div",{className:"tl-comment-input-wrapper",children:[e.jsx("input",{type:"text",className:"tl-comment-input",placeholder:"Write a comment...",value:f[a.id]||"",onChange:s=>w(n=>({...n,[a.id]:s.target.value})),onKeyPress:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),ee(a.id))},disabled:D[a.id]}),e.jsx("button",{className:"tl-comment-submit-btn",onClick:()=>ee(a.id),disabled:!f[a.id]?.trim()||D[a.id],children:D[a.id]?"...":"âž¤"})]})]})]})})]})}),A&&e.jsx("div",{className:"tl-modal-overlay",onClick:()=>$(!1),children:e.jsxs("div",{className:"tl-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"tl-modal-header",children:[e.jsxs("h3",{children:["Assigned Members (",k.length,")"]}),e.jsx("button",{onClick:()=>$(!1),children:"Ã—"})]}),e.jsx("div",{className:"tl-modal-body",children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:k.map(s=>e.jsxs("div",{style:{padding:"12px",background:"var(--background-primary)",borderRadius:"var(--radius-md)",border:"1px solid var(--border-color)",display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"var(--primary-color)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"14px"},children:(s.fullName||s.username).charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",color:"var(--text-primary)"},children:s.fullName||s.username}),s.fullName&&e.jsxs("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:["@",s.username]})]})]},s.id))})})]})}),e.jsx(fe,{isOpen:de,onClose:()=>{J(!1),Y(null)},onConfirm:()=>{q&&o(q.id,q.title),J(!1),Y(null)},title:"Delete Task",message:`Are you sure you want to delete "${q?.title}"?`,description:"This action cannot be undone. All submissions and comments associated with this task will be permanently deleted.",confirmText:"Delete Task",cancelText:"Cancel",variant:"danger"})]})},Se=({showBulkActionModal:g,setShowBulkActionModal:c,bulkAction:t,selectedFileIds:o,bulkComments:v,setBulkComments:y,isProcessing:d,submitBulkAction:x})=>g?e.jsx("div",{className:"tl-modal-overlay",onClick:()=>c(!1),children:e.jsxs("div",{className:"tl-modal",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"tl-modal-header",children:[e.jsxs("h3",{children:["Bulk ",t==="approve"?"Approve":"Reject"," (",o.length," files)"]}),e.jsx("button",{onClick:()=>c(!1),children:"Ã—"})]}),e.jsx("div",{className:"tl-modal-body",children:e.jsxs("div",{className:"tl-form-group",children:[e.jsxs("label",{children:["Comments ",t==="reject"&&"(Required)"]}),e.jsx("textarea",{value:v,onChange:p=>y(p.target.value),rows:"4",required:t==="reject",placeholder:t==="approve"?"Add optional comments...":"Please provide a reason for rejection..."})]})}),e.jsxs("div",{className:"tl-modal-footer",children:[e.jsx("button",{className:"tl-btn secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx("button",{className:`tl-btn ${t==="approve"?"success":"danger"}`,onClick:x,disabled:d||t==="reject"&&!v.trim(),children:d?"Processing...":`Confirm ${t}`})]})]})}):null,Ee=({showFilterModal:g,setShowFilterModal:c,filters:t,setFilters:o,clearFilters:v,applyFilters:y})=>g?e.jsx("div",{className:"tl-modal-overlay",onClick:()=>c(!1),children:e.jsxs("div",{className:"tl-modal",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"tl-modal-header",children:[e.jsx("h3",{children:"Filter Files"}),e.jsx("button",{onClick:()=>c(!1),children:"Ã—"})]}),e.jsxs("div",{className:"tl-modal-body",children:[e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"File Type"}),e.jsx("input",{type:"text",value:t.fileType.join(", "),onChange:d=>o({...t,fileType:d.target.value.split(",").map(x=>x.trim()).filter(x=>x)}),placeholder:"e.g., PDF, Word Document"})]}),e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Submitted By"}),e.jsx("input",{type:"text",value:t.submittedBy.join(", "),onChange:d=>o({...t,submittedBy:d.target.value.split(",").map(x=>x.trim()).filter(x=>x)}),placeholder:"Username(s)"})]}),e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Date From"}),e.jsx("input",{type:"date",value:t.dateFrom,onChange:d=>o({...t,dateFrom:d.target.value})})]}),e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Date To"}),e.jsx("input",{type:"date",value:t.dateTo,onChange:d=>o({...t,dateTo:d.target.value})})]}),e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Priority"}),e.jsxs("select",{value:t.priority,onChange:d=>o({...t,priority:d.target.value}),children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsx("div",{className:"tl-form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("input",{type:"checkbox",checked:t.hasDeadline,onChange:d=>o({...t,hasDeadline:d.target.checked})}),"Has Deadline"]})}),e.jsx("div",{className:"tl-form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("input",{type:"checkbox",checked:t.isOverdue,onChange:d=>o({...t,isOverdue:d.target.checked})}),"Is Overdue"]})})]}),e.jsxs("div",{className:"tl-modal-footer",children:[e.jsx("button",{className:"tl-btn secondary",onClick:v,children:"Clear All"}),e.jsx("button",{className:"tl-btn success",onClick:y,children:"Apply Filters"})]})]})}):null,Ae=({showPriorityModal:g,setShowPriorityModal:c,priorityValue:t,setPriorityValue:o,dueDateValue:v,setDueDateValue:y,isProcessing:d,submitPriority:x})=>g?e.jsx("div",{className:"tl-modal-overlay",onClick:()=>c(!1),children:e.jsxs("div",{className:"tl-modal",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"tl-modal-header",children:[e.jsx("h3",{children:"Set Priority & Deadline"}),e.jsx("button",{onClick:()=>c(!1),children:"Ã—"})]}),e.jsxs("div",{className:"tl-modal-body",children:[e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Priority"}),e.jsxs("select",{value:t,onChange:p=>o(p.target.value),children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Due Date"}),e.jsx("input",{type:"date",value:v,onChange:p=>y(p.target.value)})]})]}),e.jsxs("div",{className:"tl-modal-footer",children:[e.jsx("button",{className:"tl-btn secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx("button",{className:"tl-btn success",onClick:x,disabled:d,children:d?"Saving...":"Save"})]})]})}):null,Pe=({showMemberFilesModal:g,setShowMemberFilesModal:c,selectedMember:t,setSelectedMember:o,memberFiles:v,setMemberFiles:y,isLoading:d,formatFileSize:x})=>{if(!g||!t)return null;const p=()=>{c(!1),o(null),y([])};return e.jsx("div",{className:"tl-modal-overlay",onClick:p,children:e.jsxs("div",{className:"tl-modal-large",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"tl-modal-header",children:[e.jsxs("h3",{children:["Files by ",t.name]}),e.jsx("button",{onClick:p,children:"Ã—"})]}),e.jsx("div",{className:"tl-modal-body-large",children:d?e.jsxs("div",{className:"tl-loading",children:[e.jsx("div",{className:"tl-spinner"}),e.jsx("p",{children:"Loading files..."})]}):v&&v.length>0?e.jsx("div",{className:"tl-files-list",children:e.jsxs("table",{className:"tl-member-files-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"FILE NAME"}),e.jsx("th",{children:"DATE & TIME"}),e.jsx("th",{children:"TYPE"}),e.jsx("th",{children:"SIZE"}),e.jsx("th",{children:"STATUS"})]})}),e.jsx("tbody",{children:v.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"tl-file-name-cell",children:e.jsx("strong",{children:m.original_name})})}),e.jsx("td",{children:e.jsxs("div",{className:"tl-date-time-cell",children:[e.jsx("div",{children:new Date(m.uploaded_at||m.created_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}),e.jsx("div",{className:"tl-time-text",children:new Date(m.uploaded_at||m.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})})]})}),e.jsx("td",{children:e.jsx("div",{className:"tl-file-type-badge",children:m.file_type?.split(" ")[0]?.slice(0,3).toUpperCase()||"FILE"})}),e.jsx("td",{children:x(m.file_size)}),e.jsx("td",{children:e.jsx("span",{className:`status-badge status-${m.status==="approved"||m.status==="final_approved"?"approved":m.status==="rejected"||m.status==="rejected_by_team_leader"||m.status==="rejected_by_admin"?"rejected":(m.current_stage?.includes("pending_admin")||m.status==="team_leader_approved","pending")}`,children:m.status==="approved"||m.status==="final_approved"?"Approved":m.status==="rejected"||m.status==="rejected_by_team_leader"||m.status==="rejected_by_admin"?"Rejected":m.current_stage?.includes("pending_admin")||m.status==="team_leader_approved"?"Pending Admin":"Pending Team Leader"})})]},m.id))})]})}):e.jsxs("div",{className:"tl-empty",children:[e.jsx("div",{className:"tl-empty-icon",children:"ðŸ“„"}),e.jsx("h3",{children:"No files"}),e.jsx("p",{children:"This team member has not uploaded any files yet."})]})})]})})},Re=({showCreateAssignmentModal:g,setShowCreateAssignmentModal:c,assignmentForm:t,setAssignmentForm:o,teamMembers:v,isProcessing:y,createAssignment:d})=>{const[x,p]=H.useState(!1),[m,S]=H.useState(!1),[P,R]=H.useState({top:0,left:0,width:0}),[A,$]=H.useState({top:0,left:0,width:0}),k=H.useRef(null),B=H.useRef(null),N=[{value:"",label:"Any file type"},{value:"PDF",label:"PDF"},{value:"Word",label:"Word Document"},{value:"Excel",label:"Excel Spreadsheet"},{value:"PowerPoint",label:"PowerPoint Presentation"},{value:"Image",label:"Image Files"},{value:"Video",label:"Video Files"},{value:"Audio",label:"Audio Files"}];if(!g)return null;const i=()=>{c(!1),p(!1),S(!1),o({title:"",description:"",dueDate:"",fileTypeRequired:"",assignedMembers:[]})},f=a=>{const b=t.assignedMembers.includes(a)?t.assignedMembers.filter(V=>V!==a):[...t.assignedMembers,a];o({...t,assignedMembers:b})},w=()=>{if(t.assignedMembers.length===0)return"Select members...";if(t.assignedMembers.length===1){const a=v.find(b=>b.id===t.assignedMembers[0]);return a?a.name:"1 member selected"}return`${t.assignedMembers.length} members selected`},D=()=>{if(!x&&k.current){const a=k.current.getBoundingClientRect();R({top:a.bottom+6,left:a.left,width:a.width})}p(!x)},_=()=>{if(!m&&B.current){const a=B.current.getBoundingClientRect();$({top:a.bottom+6,left:a.left,width:a.width})}S(!m)},W=a=>{o({...t,fileTypeRequired:a}),S(!1)},T=()=>{const a=N.find(b=>b.value===t.fileTypeRequired);return a?a.label:"Any file type"};return e.jsx("div",{className:"tl-modal-overlay",onClick:i,children:e.jsxs("div",{className:"tl-modal-large",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"tl-modal-header",children:[e.jsx("h3",{children:"Create New Task"}),e.jsx("button",{onClick:i,children:"Ã—"})]}),e.jsx("div",{className:"tl-modal-body-large",children:e.jsxs("form",{children:[e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Task Title *"}),e.jsx("input",{type:"text",value:t.title,onChange:a=>o({...t,title:a.target.value}),placeholder:"Enter task title...",required:!0})]}),e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:t.description,onChange:a=>o({...t,description:a.target.value}),placeholder:"Enter task description...",rows:"4"})]}),e.jsxs("div",{className:"tl-form-row",children:[e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Due Date"}),e.jsx("input",{type:"date",value:t.dueDate,onChange:a=>o({...t,dueDate:a.target.value})})]}),e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"File Type Required"}),e.jsxs("div",{className:"tl-member-dropdown-wrapper",children:[e.jsxs("button",{ref:B,type:"button",className:"tl-member-dropdown-button",onClick:_,children:[e.jsx("span",{children:T()}),e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:m?"rotated":"",children:e.jsx("path",{d:"M4 6L8 10L12 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),m&&e.jsx("div",{className:"tl-member-dropdown-menu",style:{top:`${A.top}px`,left:`${A.left}px`,width:`${A.width}px`},children:N.map(a=>e.jsx("div",{className:"tl-file-type-dropdown-item",onClick:()=>W(a.value),children:e.jsx("span",{children:a.label})},a.value))})]})]})]}),e.jsxs("div",{className:"tl-form-row",children:[e.jsxs("div",{className:"tl-form-group",children:[e.jsx("label",{children:"Assign To Members *"}),e.jsxs("div",{className:"tl-member-dropdown-wrapper",children:[e.jsxs("button",{ref:k,type:"button",className:"tl-member-dropdown-button",onClick:D,children:[e.jsx("span",{children:w()}),e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:x?"rotated":"",children:e.jsx("path",{d:"M4 6L8 10L12 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),x&&e.jsx("div",{className:"tl-member-dropdown-menu",style:{top:`${P.top}px`,left:`${P.left}px`,width:`${P.width}px`},children:v.length>0?v.map(a=>e.jsxs("label",{className:"tl-member-dropdown-item",children:[e.jsx("input",{type:"checkbox",checked:t.assignedMembers.includes(a.id),onChange:()=>f(a.id)}),e.jsx("span",{children:a.name})]},a.id)):e.jsx("div",{className:"tl-member-dropdown-empty",children:"No team members available"})})]})]}),e.jsx("div",{className:"tl-form-group"})]}),e.jsxs("div",{className:"tl-modal-footer",children:[e.jsx("button",{type:"button",className:"tl-btn secondary",onClick:i,children:"Cancel"}),e.jsx("button",{type:"button",className:"tl-btn success",onClick:d,disabled:y||!t.title.trim()||t.assignedMembers.length===0,children:y?"Creating...":"Create Assignment"})]})]})})]})})},Be=({showReviewModal:g,setShowReviewModal:c,selectedFile:t,reviewAction:o,setReviewAction:v,fileComments:y,reviewComments:d,setReviewComments:x,isProcessing:p,handleReviewSubmit:m,formatFileSize:S,user:P})=>{if(!g||!t)return null;const[R,A]=j.useState(!1),$=async()=>{A(!0);try{const f=await(await fetch("http://localhost:3001/api/files/open-file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:t.file_path})})).json();f.success||alert("Failed to open file: "+(f.message||"Unknown error"))}catch(i){console.error("Error opening file:",i),alert("Failed to open file. Please try again.")}finally{A(!1)}},k=()=>{c(!1),v(null)},B=i=>{switch(i){case"uploaded":case"submitted":return"Pending Team Leader";case"team_leader_approved":return"Pending Admin";case"final_approved":return"Approved";case"rejected_by_team_leader":return"Rejected by Team Leader";case"rejected_by_admin":return"Rejected by Admin";default:return"Pending Review"}},N=i=>{switch(i){case"uploaded":case"submitted":case"team_leader_approved":return"pending";case"final_approved":return"approved";case"rejected_by_team_leader":case"rejected_by_admin":return"rejected";default:return"pending"}};return e.jsx("div",{className:"modal-overlay",onClick:k,children:e.jsxs("div",{className:"file-modal",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"File Details"}),e.jsx("button",{onClick:k,className:"modal-close",children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"file-details-section",children:[e.jsx("h4",{className:"section-title",children:"File Details"}),e.jsxs("div",{className:"file-details-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"FILE NAME:"}),e.jsx("span",{className:"detail-value",children:t.original_name})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"FILE TYPE:"}),e.jsx("span",{className:"detail-value",children:re(t.file_type,t.original_name)})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"FILE SIZE:"}),e.jsx("span",{className:"detail-value",children:S(t.file_size)})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"SUBMITTED BY:"}),e.jsx("span",{className:"detail-value",children:t.fullName||t.username})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"TEAM:"}),e.jsx("span",{className:"detail-value team-badge-inline",children:t.team||P.team})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"UPLOAD DATE:"}),e.jsx("span",{className:"detail-value",children:new Date(t.submitted_at||t.created_at||t.upload_date).toLocaleString()})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"STATUS:"}),e.jsx("span",{className:`detail-value status-badge status-${N(t.status||t.current_stage)}`,children:B(t.status||t.current_stage)})]})]})]}),t.description&&e.jsxs("div",{className:"description-section",children:[e.jsx("h4",{className:"section-title",children:"Description"}),e.jsx("div",{className:"description-box",children:e.jsx("p",{className:"description-text",children:t.description})})]}),(t.status==="team_leader_approved"||t.status==="final_approved"||t.status==="rejected_by_team_leader"||t.status==="rejected_by_admin")&&e.jsx("div",{className:"review-notice",style:{padding:"12px 16px",background:t.status==="team_leader_approved"?"#FEF3C7":t.status==="final_approved"?"#D1FAE5":"#FEE2E2",border:"1px solid "+(t.status==="team_leader_approved"?"#FCD34D":t.status==="final_approved"?"#34D399":"#FCA5A5"),borderRadius:"8px",marginBottom:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",style:{color:t.status==="team_leader_approved"?"#92400E":t.status==="final_approved"?"#065F46":"#991B1B"},children:[e.jsx("path",{d:"M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M10 6V10M10 14H10.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),e.jsx("span",{style:{fontWeight:"500",color:t.status==="team_leader_approved"?"#92400E":t.status==="final_approved"?"#065F46":"#991B1B"},children:t.status==="team_leader_approved"?"This file has been approved by you and is now pending admin review.":t.status==="final_approved"?"This file has been fully approved and published.":"This file has been rejected and cannot be re-reviewed."})]})}),e.jsx("div",{className:"actions-section",children:e.jsxs("div",{className:"action-buttons-large",children:[e.jsxs("button",{type:"button",onClick:i=>{i.preventDefault(),v("approve"),m({preventDefault:()=>{}})},className:"btn btn-success-large",disabled:p||t.status==="team_leader_approved"||t.status==="final_approved"||t.status==="rejected_by_team_leader"||t.status==="rejected_by_admin",children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M16.875 5L7.5 14.375L3.125 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Approve"]}),e.jsxs("button",{type:"button",onClick:i=>{if(i.preventDefault(),!d.trim()){alert("Please add a rejection reason in the comment box above");return}v("reject"),m({preventDefault:()=>{}})},className:"btn btn-danger-large",disabled:p||t.status==="team_leader_approved"||t.status==="final_approved"||t.status==="rejected_by_team_leader"||t.status==="rejected_by_admin",children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M15 5L5 15M5 5L15 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Reject"]}),e.jsxs("button",{type:"button",onClick:$,className:"btn btn-secondary-large",disabled:p||R,children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M10 2.5V10M10 10V17.5M10 10H17.5M10 10H2.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),R?"Opening...":"Open File"]})]})})]})]})})},$e=({showModal:g,setShowModal:c,selectedFile:t,formatFileSize:o,user:v})=>{if(!g||!t)return null;const y=()=>{c(!1)},d=p=>{switch(p){case"uploaded":case"submitted":return"Pending Team Leader";case"team_leader_approved":return"Pending Admin";case"final_approved":case"approved":return"Approved";case"rejected_by_team_leader":return"Rejected by Team Leader";case"rejected_by_admin":return"Rejected by Admin";case"rejected":return"Rejected";default:return"Pending Review"}},x=p=>{switch(p){case"uploaded":case"submitted":case"team_leader_approved":return"pending";case"final_approved":case"approved":return"approved";case"rejected_by_team_leader":case"rejected_by_admin":case"rejected":return"rejected";default:return"pending"}};return e.jsx("div",{className:"modal-overlay",onClick:y,children:e.jsxs("div",{className:"file-modal",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"File Details"}),e.jsx("button",{onClick:y,className:"modal-close",children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"file-details-section",children:[e.jsx("h4",{className:"section-title",children:"File Information"}),e.jsxs("div",{className:"file-details-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"FILE NAME:"}),e.jsx("span",{className:"detail-value",children:t.original_name})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"FILE TYPE:"}),e.jsx("span",{className:"detail-value",children:re(t.file_type,t.original_name)})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"FILE SIZE:"}),e.jsx("span",{className:"detail-value",children:o(t.file_size)})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"SUBMITTED BY:"}),e.jsx("span",{className:"detail-value",children:t.fullName||t.username})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"TEAM:"}),e.jsx("span",{className:"detail-value team-badge-inline",children:t.team||v.team})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"SUBMITTED DATE:"}),e.jsx("span",{className:"detail-value",children:new Date(t.submitted_at||t.uploaded_at||t.created_at).toLocaleString()})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"STATUS:"}),e.jsx("span",{className:`detail-value status-badge status-${x(t.status)}`,children:d(t.status)})]})]})]}),t.assignment_title&&e.jsxs("div",{className:"description-section",children:[e.jsx("h4",{className:"section-title",children:"Assignment"}),e.jsxs("div",{className:"file-details-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"TITLE:"}),e.jsx("span",{className:"detail-value",children:t.assignment_title})]}),t.assignment_due_date&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"DUE DATE:"}),e.jsx("span",{className:"detail-value",children:new Date(t.assignment_due_date).toLocaleDateString()})]})]})]}),t.description&&e.jsxs("div",{className:"description-section",children:[e.jsx("h4",{className:"section-title",children:"Description"}),e.jsx("div",{className:"description-box",children:e.jsx("p",{className:"description-text",children:t.description})})]}),e.jsx("div",{className:"actions-section",children:e.jsx("div",{className:"action-buttons-large",children:e.jsxs("button",{type:"button",onClick:()=>window.open(`http://localhost:3001${t.file_path}`,"_blank"),className:"btn btn-primary",style:{flex:1},children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M15 10.8333V15.8333C15 16.2754 14.8244 16.6993 14.5118 17.0118C14.1993 17.3244 13.7754 17.5 13.3333 17.5H4.16667C3.72464 17.5 3.30072 17.3244 2.98816 17.0118C2.67559 16.6993 2.5 16.2754 2.5 15.8333V6.66667C2.5 6.22464 2.67559 5.80072 2.98816 5.48816C3.30072 5.17559 3.72464 5 4.16667 5H9.16667M12.5 2.5H17.5M17.5 2.5V7.5M17.5 2.5L8.33333 11.6667",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Open File"]})})})]})]})})};export{Ve as AlertMessage,Le as AssignmentsTab,Se as BulkActionModal,Re as CreateAssignmentModal,Te as FileCollectionTab,$e as FileViewModal,Ee as FilterModal,Pe as MemberFilesModal,we as NotificationBell,He as NotificationTab,De as OverviewTab,Ae as PriorityModal,Be as ReviewModal,Oe as Sidebar,Me as TeamManagementTab,ke as TopBar};
